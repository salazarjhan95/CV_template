%%%%%%%%%%%%%%%
% This CV example/template is based on my own
% CV which I (lamely attempted) to clean up, so that
% it's less of an eyesore and easier for others to use.
%
% LianTze Lim (liantze@gmail.com)
% 23 Oct, 2022
% 24 Aug, 2024 -- added simpleicons to provide X-twitter icon

% I have made some modification to the original version published by LianTze Lim, I wanted to make it more personal and keep it in the format that people in my field usually use

\RequirePackage{silence}
\WarningsOff[longtable]
\WarningsOff[array]

\usepackage{ifxetex,ifluatex}
\newif\ifxetexorluatex
\ifxetex
  \xetexorluatextrue
\else
  \ifluatex
    \xetexorluatextrue
  \else
    \xetexorluatexfalse
  \fi
\fi

\RequirePackage{graphicx}
\RequirePackage[hyphens]{url}
\RequirePackage{babel}
\raggedright

\RequirePackage[fixed]{fontawesome5}
\RequirePackage{simpleicons}
 \RequirePackage{academicons}
 
\newcommand{\smallcaps}[1]{\textsc{\lowercase{#1}}}

\RequirePackage[a4paper,nohead,nofoot,hmargin=2.25cm,vmargin=2cm]{geometry}
\RequirePackage{relsize}
\RequirePackage[dvipsnames,svgnames]{xcolor}
\RequirePackage{tikz}
\usetikzlibrary{shapes,shadows}

\RequirePackage{comment}
\definecolor{SwishLineColour}{HTML}{8D8C89}
\definecolor{MarkerColour}{HTML}{A3CEF1}

% If you're not a researcher nor an academic, you probably don't need biblatex; delete this line.
\RequirePackage[style=ext-authoryear,giveninits,dashed=false,
    maxnames=10,
    minnames=10]{biblatex}
% giveninits: by default ext-authoryear lists the full given names but in case you might want to use initials
% dashed=false: by default repeated authors for consecutive entries are replaced by a dash; in case you don't want that

% By default ext-authoryear prints first author as "family, given" but if you want all to be given (initials) family for all
\DeclareNameAlias{author}{given-family}

% ext-authoryear makes it possible to customise biblabeldate field format to make it bold, add parentheses, etc
\DeclareFieldFormat{biblabeldate}{\addperiod\space{\mkbibparens{\mkbibbold{#1}}}}

\RequirePackage{csquotes}

\RequirePackage{tikz}
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
   \node[shape=circle,text=white,fill=MarkerColour!80!black,font=\sffamily\scriptsize\bfseries,inner sep=1pt,text height=1.35ex,minimum width=1.5em,text centered] (char) {#1};}}






%% For artcile, proceedings and book chapters.
%% I modified the following part to show the articles, book chapters or proceedings in decending
%% order., but since I only have articles so far, I blocked the lines for book chapters and proceedings

%\usepackage{tikz}
\usepackage[style=ext-authoryear,giveninits,dashed=false]{biblatex}

%\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
  % \node[shape=circle, text=white, fill=MarkerColour!80!black, font=\sffamily\scriptsize\bfseries, 
   %inner sep=1pt, text height=1.35ex, minimum width=1.5em, text centered] (char) {#1};}}

% Create separate counters for articles, chapters, and conferences
\newcounter{article}
\newcounter{booksandchapters}
\newcounter{inproceedings}

% Set starting values for each counter
\newcommand{\setArticleBibCounter}{\setcounter{article}{9}} % Start at 9
\newcommand{\setChapterBibCounter}{\setcounter{booksandchapters}{2}} % Start at 11
\newcommand{\setConferenceBibCounter}{\setcounter{inproceedings}{11}} % Start at 2

% Article bibliography
\newcommand{\articleBibliography}{
  \setArticleBibCounter % Initialize article counter
  \AtEveryBibitem{
    \ifentrytype{article}{ % Check if the entry is an article
      \makebox[1.5em][l]{\circled{\thearticle}} % Display circled number
      \addtocounter{article}{-1} % Decrement counter
    }{}
  }
}

% Chapter bibliography
\newcommand{\chapterBibliography}{
  \setChapterBibCounter % Initialize chapter counter
  \AtEveryBibitem{
    \ifentrytype{incollection}{ % Check if the entry is a chapter
      \makebox[0.8em][l]{\circled{\thebooksandchapters}} % Display circled number
      \addtocounter{booksandchapters}{-1} % Decrement counter
    }{}
  }
}

% Conference bibliography
\newcommand{\conferenceBibliography}{
  \setConferenceBibCounter % Initialize conference counter
  \AtEveryBibitem{
    \ifentrytype{inproceedings}{ % Check if the entry is a conference proceeding
      \makebox[1.8em][l]{\circled{\theinproceedings}} % Display circled number
      \addtocounter{inproceedings}{-1} % Decrement counter
    }{}
  }
}


%% I'M GOING TO LOCK THIS FOR NOW, BUT IF IT DOESNT WORK, UNLOCK IT
% General settings for biblatex
%\addbibresource{own-bib.bib} % Replace with your .bib file

% Create sections in the bibliography
%\printbibliography[filter=booksandchapters, heading=subbibliography, title={Books and Chapters}]
%\chapterBibliography % Apply custom style for chapters

%\printbibliography[filter=article, heading=subbibliography, title={Articles}]
%\articleBibliography % Apply custom style for articles

%\printbibliography[filter=inproceedings, heading=subbibliography, title={Conference Proceedings}]
%\conferenceBibliography % Apply custom style for conferences



%% Just for Articles
% General settings for biblatex
%\addbibresource{own-bib.bib} % Replace with your .bib file

% Create sections in the bibliography
%\printbibliography[filter=booksandchapters, heading=subbibliography, title={Books and Chapters}]
%\chapterBibliography % Apply custom style for chapters

%\printbibliography[filter=article, heading=subbibliography, title={Articles}]
%\articleBibliography % Apply custom style for articles

%\printbibliography[filter=inproceedings, heading=subbibliography, title={Conference Proceedings}]
%\conferenceBibliography % Apply custom style for conferences






% Putting the references in decending order
% This is a REALLY important line, this is goign to help you putting your publications in decending order. If you don't want to do this, you can just use the original version created by LianTze Lim. Also, if you have any further question you can ask Dr. Lim, she reply really fast!

\newcounter{bibitem}
\AtBeginBibliography{\setcounter{bibitem}{11}}  % Initialize counter at 11
\iffieldformatundef{labelnumberwidth}{%
  % if author-year style
  \AtEveryBibitem{\makebox[2.5em][l]{\circled{\thebibitem}\addtocounter{bibitem}{-1}}}%
}{%
  % if numeric style
  \DeclareFieldFormat{labelnumberwidth}{\makebox[2.5em][l]{\circled{\thebibitem}}}%
  \setlength{\biblabelsep}{0pt}%
  \AtEveryBibitem{\addtocounter{bibitem}{-1}}  % Decrement counter
}
\AtEveryBibitem{\iffieldundef{doi}{}{\clearfield{url}}}





% \renewcommand{\bibfont}{\small}
\setlength{\bibitemsep}{1.5ex}
\setlength{\bibhang}{2.5em}
\RequirePackage{xpatch}
\xpretofieldformat{doi}
  {\textcolor{MarkerColour!80!black}{\scriptsize\faLink}}
  {}{}
\xpretofieldformat{url}
  {\textcolor{MarkerColour!80!black}{\scriptsize\faLink}}
  {}{}

\headerscale{1}
%\setlength{\headerspace}{6pt}
\rubricfont{\Large\bfseries\sffamily}
\setlength{\rubricspace}{2pt}
%\setlength{\rubricafterspace}{-9pt}
\setlength{\rubricafterspace}{-3pt}
\setlength{\subrubricspace}{3pt}
\setlength{\subrubricbeforespace}{4pt}
\def\@@rubrichead#1{%
  \begin{tikzpicture}[baseline]%\
  \shade[left color=SwishLineColour!60!white, right color=white] rectangle (\@almosttextwidth,2.5pt);
  \node[font={\@rubricfont},inner sep=0pt,text ragged,anchor=south west,text depth=.5ex,text height=1.5ex] at (1pt,2pt) {#1};
  \end{tikzpicture}%
  \vspace\rubricspace%
}

\subrubricfont{\large\bfseries\sffamily}
\subrubricalignment{l}

\newcommand{\makefield}[2]{\makebox[1.5em]{\color{MarkerColour!80!black}#1} #2\hspace{2em}}

\keyalignment{r}
\rubricalignment{l}
\renewcommand{\arraystretch}{1.25}
\urlstyle{tt}

\newcommand{\prefixmarker}[1]{\def\@prefixmarker{#1}}
\def\@prefixmarker{\relscale{.9}\faBookmark}

\prefix{%
  \hspace*{-1ex}
  \color{MarkerColour!80!black}\@prefixmarker%
  \hspace*{1ex}%
}

\newcommand{\makerubrichead}[1]{\vskip\baselineskip\@@rubrichead{#1}}

\defbibheading{subbibliography}{\vskip\subrubricbeforespace{\@subrubricfont\hspace{3pt}#1}\par}

\defbibfilter{booksandchapters}{%
( type=book or type=incollection )
}

\RequirePackage{pgffor}
\newcommand{\mynames}[1]{\def\my@namelist{#1}}
\newtoggle{boldname}
\renewcommand*{\mkbibnamefamily}[1]{%
  \global\togglefalse{boldname}%
  \foreach \my@fname / \my@gname in \my@namelist {%
    \ifboolexpr{ test {\ifdefstrequal{\namepartfamily}{\my@fname}}
                 and
                 test {\ifdefstrequal{\namepartgiven}{\my@gname}}}
      {\global\toggletrue{boldname}}{}%
  }%
  \iftoggle{boldname}{\textbf{#1}}{#1}%
}

\renewcommand*{\mkbibnamegiven}[1]{%
  \global\togglefalse{boldname}%
  \foreach \my@fname / \my@gname in \my@namelist{%
    \ifboolexpr{ test {\ifdefstrequal{\namepartfamily}{\my@fname}}
                 and
                 test {\ifdefstrequal{\namepartgiven}{\my@gname}}}
      {\global\toggletrue{boldname}\breakforeach}{}%
  }%
  \iftoggle{boldname}{\textbf{#1}}{#1}%
}


\RequirePackage[colorlinks=true,allcolors=black,breaklinks=true]{hyperref}

